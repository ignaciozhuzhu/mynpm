var mysql = require('mysql');  
router.get('/add/product', function(req, res, next){  
  var connection = mysql.createConnection({
    host     : 'localhost',
    user     : 'root',
    password : 'root',
    database: 'test'
  });

  connection.connect();

  connection.query("select max_key from `keys` where table_name='product'", function(err, rows, fields){
    if(err){
      return next(err);
    }

    var max_key = rows[0].max_key+1;
    var sql = util.format("update `keys` set max_key=%s where table_name='%s'", max_key, 'product');

    connection.query(sql, function(err, rows, fields){
      if(err){
        return next(err);
      }

      connection.query("insert into product(`key`, `name`) values(" + max_key + ", 'name')", function(err){
        if(err){
          return next(err);
        }

        connection.end();
        res.send({
          message: '–¥»Î≥…π¶'
        });
      })
    });
  });
});
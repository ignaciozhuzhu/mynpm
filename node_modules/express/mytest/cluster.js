var cluster = require('cluster'); 
var http = require('http'); 

function sleep2(numberMillis) { var now = new Date(); var exitTime = now.getTime() + numberMillis; while (true) { now = new Date(); if (now.getTime() > exitTime) return; } }
 
if (cluster.isMaster) { 
  var numCPUs = require('os').cpus().length; 
  var data = 0; 
  // 启动多个进程. 
  for (var i = 0; i < 4; i++) { 
   //增加一个进程 
    var worker_process = cluster.fork(); 
    //侦听子进程的message事件 
    worker_process.on('message', function(msg) { 
      if (msg.cmd && msg.cmd == 'notifyRequest') { 
        data++; 
        console.log('DATA VALUE : %d ', data);
        sleep2(3000);
	//	setTimeout(function() { console.log('DATA VALUE2 : %d ', data);}, 10000);
	//	setTimeout(console.log('DATA VALUE2 : %d ', data), 5000);  

      }
    }); 
  } 
} else { 
    process.send({ cmd: 'notifyRequest' }); 
} 